<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>33 Trend Analysis | Technical Documentation, State of the Ecosystem Report</title>
  <meta name="description" content="This book documents each indicator and analysis used in State of the Ecosystem reporting" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="33 Trend Analysis | Technical Documentation, State of the Ecosystem Report" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book documents each indicator and analysis used in State of the Ecosystem reporting" />
  <meta name="github-repo" content="NOAA-EDAB/tech-doc" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="33 Trend Analysis | Technical Documentation, State of the Ecosystem Report" />
  
  <meta name="twitter:description" content="This book documents each indicator and analysis used in State of the Ecosystem reporting" />
  

<meta name="author" content="Northeast Fisheries Science Center" />


<meta name="date" content="2019-08-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="thermal-habitat-projections.html">
<link rel="next" href="zooabund.html">
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="assets/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Technical Documentation, State of the Ecosystem Report</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="erddap.html"><a href="erddap.html"><i class="fa fa-check"></i><b>1</b> Data and Code Access</a><ul>
<li class="chapter" data-level="1.0.1" data-path="erddap.html"><a href="erddap.html#about"><i class="fa fa-check"></i><b>1.0.1</b> About</a></li>
<li class="chapter" data-level="1.0.2" data-path="erddap.html"><a href="erddap.html#accessing-source-data-and-build-code"><i class="fa fa-check"></i><b>1.0.2</b> Accessing source data and build code</a></li>
<li class="chapter" data-level="1.0.3" data-path="erddap.html"><a href="erddap.html#building-the-document"><i class="fa fa-check"></i><b>1.0.3</b> Building the document</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="aggroups.html"><a href="aggroups.html"><i class="fa fa-check"></i><b>2</b> Aggregate Groups</a><ul>
<li class="chapter" data-level="2.1" data-path="aggroups.html"><a href="aggroups.html#methods"><i class="fa fa-check"></i><b>2.1</b> Methods</a><ul>
<li class="chapter" data-level="2.1.1" data-path="aggroups.html"><a href="aggroups.html#data-sources"><i class="fa fa-check"></i><b>2.1.1</b> Data sources</a></li>
<li class="chapter" data-level="2.1.2" data-path="aggroups.html"><a href="aggroups.html#data-extraction"><i class="fa fa-check"></i><b>2.1.2</b> Data extraction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="annual-sst-cycles.html"><a href="annual-sst-cycles.html"><i class="fa fa-check"></i><b>3</b> Annual SST Cycles</a><ul>
<li class="chapter" data-level="3.1" data-path="annual-sst-cycles.html"><a href="annual-sst-cycles.html#methods-1"><i class="fa fa-check"></i><b>3.1</b> Methods</a><ul>
<li class="chapter" data-level="3.1.1" data-path="annual-sst-cycles.html"><a href="annual-sst-cycles.html#data-sources-1"><i class="fa fa-check"></i><b>3.1.1</b> Data sources</a></li>
<li class="chapter" data-level="3.1.2" data-path="annual-sst-cycles.html"><a href="annual-sst-cycles.html#data-extraction-1"><i class="fa fa-check"></i><b>3.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="3.1.3" data-path="annual-sst-cycles.html"><a href="annual-sst-cycles.html#data-analysis"><i class="fa fa-check"></i><b>3.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="3.1.4" data-path="annual-sst-cycles.html"><a href="annual-sst-cycles.html#plotting"><i class="fa fa-check"></i><b>3.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="aquaculture.html"><a href="aquaculture.html"><i class="fa fa-check"></i><b>4</b> Aquaculture</a><ul>
<li class="chapter" data-level="4.1" data-path="aquaculture.html"><a href="aquaculture.html#methods-2"><i class="fa fa-check"></i><b>4.1</b> Methods</a><ul>
<li class="chapter" data-level="4.1.1" data-path="aquaculture.html"><a href="aquaculture.html#data-sources-2"><i class="fa fa-check"></i><b>4.1.1</b> Data sources</a></li>
<li class="chapter" data-level="4.1.2" data-path="aquaculture.html"><a href="aquaculture.html#data-extraction-2"><i class="fa fa-check"></i><b>4.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="4.1.3" data-path="aquaculture.html"><a href="aquaculture.html#data-analysis-1"><i class="fa fa-check"></i><b>4.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="4.1.4" data-path="aquaculture.html"><a href="aquaculture.html#data-processing"><i class="fa fa-check"></i><b>4.1.4</b> Data processing</a></li>
<li class="chapter" data-level="4.1.5" data-path="aquaculture.html"><a href="aquaculture.html#plotting-1"><i class="fa fa-check"></i><b>4.1.5</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bennet-indicator.html"><a href="bennet-indicator.html"><i class="fa fa-check"></i><b>5</b> Bennet Indicator</a><ul>
<li class="chapter" data-level="5.1" data-path="bennet-indicator.html"><a href="bennet-indicator.html#methods-3"><i class="fa fa-check"></i><b>5.1</b> Methods</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bennet-indicator.html"><a href="bennet-indicator.html#data-sources-3"><i class="fa fa-check"></i><b>5.1.1</b> Data sources</a></li>
<li class="chapter" data-level="5.1.2" data-path="bennet-indicator.html"><a href="bennet-indicator.html#data-extraction-3"><i class="fa fa-check"></i><b>5.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="5.1.3" data-path="bennet-indicator.html"><a href="bennet-indicator.html#data-analysis-2"><i class="fa fa-check"></i><b>5.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="5.1.4" data-path="bennet-indicator.html"><a href="bennet-indicator.html#data-processing-1"><i class="fa fa-check"></i><b>5.1.4</b> Data processing</a></li>
<li class="chapter" data-level="5.1.5" data-path="bennet-indicator.html"><a href="bennet-indicator.html#plotting-2"><i class="fa fa-check"></i><b>5.1.5</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bottom-temperatures.html"><a href="bottom-temperatures.html"><i class="fa fa-check"></i><b>6</b> Bottom temperatures</a><ul>
<li class="chapter" data-level="6.1" data-path="bottom-temperatures.html"><a href="bottom-temperatures.html#methods-4"><i class="fa fa-check"></i><b>6.1</b> Methods</a><ul>
<li class="chapter" data-level="6.1.1" data-path="bottom-temperatures.html"><a href="bottom-temperatures.html#data-sources-4"><i class="fa fa-check"></i><b>6.1.1</b> Data sources</a></li>
<li class="chapter" data-level="6.1.2" data-path="bottom-temperatures.html"><a href="bottom-temperatures.html#data-extraction-4"><i class="fa fa-check"></i><b>6.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="6.1.3" data-path="bottom-temperatures.html"><a href="bottom-temperatures.html#data-analysis-3"><i class="fa fa-check"></i><b>6.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="6.1.4" data-path="bottom-temperatures.html"><a href="bottom-temperatures.html#data-processing-2"><i class="fa fa-check"></i><b>6.1.4</b> Data processing</a></li>
<li class="chapter" data-level="6.1.5" data-path="bottom-temperatures.html"><a href="bottom-temperatures.html#plotting-3"><i class="fa fa-check"></i><b>6.1.5</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="catch-and-fleet-diversity.html"><a href="catch-and-fleet-diversity.html"><i class="fa fa-check"></i><b>7</b> Catch and Fleet Diversity</a><ul>
<li class="chapter" data-level="7.1" data-path="catch-and-fleet-diversity.html"><a href="catch-and-fleet-diversity.html#methods-5"><i class="fa fa-check"></i><b>7.1</b> Methods</a><ul>
<li class="chapter" data-level="7.1.1" data-path="catch-and-fleet-diversity.html"><a href="catch-and-fleet-diversity.html#data-sources-5"><i class="fa fa-check"></i><b>7.1.1</b> Data sources</a></li>
<li class="chapter" data-level="7.1.2" data-path="catch-and-fleet-diversity.html"><a href="catch-and-fleet-diversity.html#data-extraction-5"><i class="fa fa-check"></i><b>7.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="7.1.3" data-path="catch-and-fleet-diversity.html"><a href="catch-and-fleet-diversity.html#data-analysis-4"><i class="fa fa-check"></i><b>7.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="7.1.4" data-path="catch-and-fleet-diversity.html"><a href="catch-and-fleet-diversity.html#data-processing-3"><i class="fa fa-check"></i><b>7.1.4</b> Data processing</a></li>
<li class="chapter" data-level="7.1.5" data-path="catch-and-fleet-diversity.html"><a href="catch-and-fleet-diversity.html#plotting-4"><i class="fa fa-check"></i><b>7.1.5</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chesapeake-bay-water-quality-standards-attainment.html"><a href="chesapeake-bay-water-quality-standards-attainment.html"><i class="fa fa-check"></i><b>8</b> Chesapeake Bay Water Quality Standards Attainment</a><ul>
<li class="chapter" data-level="8.1" data-path="chesapeake-bay-water-quality-standards-attainment.html"><a href="chesapeake-bay-water-quality-standards-attainment.html#methods-6"><i class="fa fa-check"></i><b>8.1</b> Methods</a><ul>
<li class="chapter" data-level="8.1.1" data-path="chesapeake-bay-water-quality-standards-attainment.html"><a href="chesapeake-bay-water-quality-standards-attainment.html#data-sources-6"><i class="fa fa-check"></i><b>8.1.1</b> Data sources</a></li>
<li class="chapter" data-level="8.1.2" data-path="chesapeake-bay-water-quality-standards-attainment.html"><a href="chesapeake-bay-water-quality-standards-attainment.html#data-analysis-5"><i class="fa fa-check"></i><b>8.1.2</b> Data analysis</a></li>
<li class="chapter" data-level="8.1.3" data-path="chesapeake-bay-water-quality-standards-attainment.html"><a href="chesapeake-bay-water-quality-standards-attainment.html#data-processing-4"><i class="fa fa-check"></i><b>8.1.3</b> Data processing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chl-pp.html"><a href="chl-pp.html"><i class="fa fa-check"></i><b>9</b> Chlorophyll <em>a</em> and Primary Production</a><ul>
<li class="chapter" data-level="9.1" data-path="chl-pp.html"><a href="chl-pp.html#methods-7"><i class="fa fa-check"></i><b>9.1</b> Methods</a><ul>
<li class="chapter" data-level="9.1.1" data-path="chl-pp.html"><a href="chl-pp.html#data-sources-7"><i class="fa fa-check"></i><b>9.1.1</b> Data sources</a></li>
<li class="chapter" data-level="9.1.2" data-path="chl-pp.html"><a href="chl-pp.html#data-extraction-6"><i class="fa fa-check"></i><b>9.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="9.1.3" data-path="chl-pp.html"><a href="chl-pp.html#data-analysis-6"><i class="fa fa-check"></i><b>9.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="9.1.4" data-path="chl-pp.html"><a href="chl-pp.html#data-processing-5"><i class="fa fa-check"></i><b>9.1.4</b> Data processing</a></li>
<li class="chapter" data-level="9.1.5" data-path="chl-pp.html"><a href="chl-pp.html#plotting-5"><i class="fa fa-check"></i><b>9.1.5</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fishing-community-climate-vulnerability.html"><a href="fishing-community-climate-vulnerability.html"><i class="fa fa-check"></i><b>10</b> Fishing Community Climate Vulnerability</a><ul>
<li class="chapter" data-level="10.1" data-path="fishing-community-climate-vulnerability.html"><a href="fishing-community-climate-vulnerability.html#methods-8"><i class="fa fa-check"></i><b>10.1</b> Methods</a><ul>
<li class="chapter" data-level="10.1.1" data-path="fishing-community-climate-vulnerability.html"><a href="fishing-community-climate-vulnerability.html#data-sources-8"><i class="fa fa-check"></i><b>10.1.1</b> Data sources</a></li>
<li class="chapter" data-level="10.1.2" data-path="fishing-community-climate-vulnerability.html"><a href="fishing-community-climate-vulnerability.html#data-extraction-7"><i class="fa fa-check"></i><b>10.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="10.1.3" data-path="fishing-community-climate-vulnerability.html"><a href="fishing-community-climate-vulnerability.html#data-analysis-7"><i class="fa fa-check"></i><b>10.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="10.1.4" data-path="fishing-community-climate-vulnerability.html"><a href="fishing-community-climate-vulnerability.html#plotting-6"><i class="fa fa-check"></i><b>10.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="conceptual-models.html"><a href="conceptual-models.html"><i class="fa fa-check"></i><b>11</b> Conceptual Models</a><ul>
<li class="chapter" data-level="11.1" data-path="conceptual-models.html"><a href="conceptual-models.html#methods-9"><i class="fa fa-check"></i><b>11.1</b> Methods</a><ul>
<li class="chapter" data-level="11.1.1" data-path="conceptual-models.html"><a href="conceptual-models.html#data-sources-9"><i class="fa fa-check"></i><b>11.1.1</b> Data sources</a></li>
<li class="chapter" data-level="11.1.2" data-path="conceptual-models.html"><a href="conceptual-models.html#data-extraction-8"><i class="fa fa-check"></i><b>11.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="11.1.3" data-path="conceptual-models.html"><a href="conceptual-models.html#data-analysis-8"><i class="fa fa-check"></i><b>11.1.3</b> Data analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="fish-condition-indicator.html"><a href="fish-condition-indicator.html"><i class="fa fa-check"></i><b>12</b> Fish Condition Indicator</a><ul>
<li class="chapter" data-level="12.1" data-path="fish-condition-indicator.html"><a href="fish-condition-indicator.html#methods-10"><i class="fa fa-check"></i><b>12.1</b> Methods</a><ul>
<li class="chapter" data-level="12.1.1" data-path="fish-condition-indicator.html"><a href="fish-condition-indicator.html#data-sources-10"><i class="fa fa-check"></i><b>12.1.1</b> Data sources</a></li>
<li class="chapter" data-level="12.1.2" data-path="fish-condition-indicator.html"><a href="fish-condition-indicator.html#data-extraction-9"><i class="fa fa-check"></i><b>12.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="12.1.3" data-path="fish-condition-indicator.html"><a href="fish-condition-indicator.html#data-analysis-9"><i class="fa fa-check"></i><b>12.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="12.1.4" data-path="fish-condition-indicator.html"><a href="fish-condition-indicator.html#plotting-7"><i class="fa fa-check"></i><b>12.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="epu.html"><a href="epu.html"><i class="fa fa-check"></i><b>13</b> Ecological Production Units</a><ul>
<li class="chapter" data-level="13.1" data-path="epu.html"><a href="epu.html#methods-11"><i class="fa fa-check"></i><b>13.1</b> Methods</a><ul>
<li class="chapter" data-level="13.1.1" data-path="epu.html"><a href="epu.html#data-sources-11"><i class="fa fa-check"></i><b>13.1.1</b> Data sources</a></li>
<li class="chapter" data-level="13.1.2" data-path="epu.html"><a href="epu.html#data-extraction-10"><i class="fa fa-check"></i><b>13.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="13.1.3" data-path="epu.html"><a href="epu.html#data-analysis-10"><i class="fa fa-check"></i><b>13.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="13.1.4" data-path="epu.html"><a href="epu.html#data-processing-6"><i class="fa fa-check"></i><b>13.1.4</b> Data processing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="gulf-stream-index.html"><a href="gulf-stream-index.html"><i class="fa fa-check"></i><b>14</b> Gulf Stream Index</a><ul>
<li class="chapter" data-level="14.1" data-path="gulf-stream-index.html"><a href="gulf-stream-index.html#methods-12"><i class="fa fa-check"></i><b>14.1</b> Methods</a><ul>
<li class="chapter" data-level="14.1.1" data-path="gulf-stream-index.html"><a href="gulf-stream-index.html#data-sources-12"><i class="fa fa-check"></i><b>14.1.1</b> Data sources</a></li>
<li class="chapter" data-level="14.1.2" data-path="gulf-stream-index.html"><a href="gulf-stream-index.html#data-analysis-11"><i class="fa fa-check"></i><b>14.1.2</b> Data analysis</a></li>
<li class="chapter" data-level="14.1.3" data-path="gulf-stream-index.html"><a href="gulf-stream-index.html#data-processing-7"><i class="fa fa-check"></i><b>14.1.3</b> Data Processing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="harbor-porpoise-bycatch.html"><a href="harbor-porpoise-bycatch.html"><i class="fa fa-check"></i><b>15</b> Harbor Porpoise Bycatch</a><ul>
<li class="chapter" data-level="15.1" data-path="harbor-porpoise-bycatch.html"><a href="harbor-porpoise-bycatch.html#methods-13"><i class="fa fa-check"></i><b>15.1</b> Methods</a><ul>
<li class="chapter" data-level="15.1.1" data-path="harbor-porpoise-bycatch.html"><a href="harbor-porpoise-bycatch.html#data-sources-13"><i class="fa fa-check"></i><b>15.1.1</b> Data sources</a></li>
<li class="chapter" data-level="15.1.2" data-path="harbor-porpoise-bycatch.html"><a href="harbor-porpoise-bycatch.html#data-extraction-11"><i class="fa fa-check"></i><b>15.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="15.1.3" data-path="harbor-porpoise-bycatch.html"><a href="harbor-porpoise-bycatch.html#data-analysis-12"><i class="fa fa-check"></i><b>15.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="15.1.4" data-path="harbor-porpoise-bycatch.html"><a href="harbor-porpoise-bycatch.html#plotting-8"><i class="fa fa-check"></i><b>15.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ichthyoplankton-diversity.html"><a href="ichthyoplankton-diversity.html"><i class="fa fa-check"></i><b>16</b> Ichthyoplankton Diversity</a><ul>
<li class="chapter" data-level="16.1" data-path="ichthyoplankton-diversity.html"><a href="ichthyoplankton-diversity.html#methods-14"><i class="fa fa-check"></i><b>16.1</b> Methods</a><ul>
<li class="chapter" data-level="16.1.1" data-path="ichthyoplankton-diversity.html"><a href="ichthyoplankton-diversity.html#data-sources-14"><i class="fa fa-check"></i><b>16.1.1</b> Data sources</a></li>
<li class="chapter" data-level="16.1.2" data-path="ichthyoplankton-diversity.html"><a href="ichthyoplankton-diversity.html#data-extraction-12"><i class="fa fa-check"></i><b>16.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="16.1.3" data-path="ichthyoplankton-diversity.html"><a href="ichthyoplankton-diversity.html#data-analysis-13"><i class="fa fa-check"></i><b>16.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="16.1.4" data-path="ichthyoplankton-diversity.html"><a href="ichthyoplankton-diversity.html#data-processing-8"><i class="fa fa-check"></i><b>16.1.4</b> Data processing</a></li>
<li class="chapter" data-level="16.1.5" data-path="ichthyoplankton-diversity.html"><a href="ichthyoplankton-diversity.html#plotting-9"><i class="fa fa-check"></i><b>16.1.5</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="comdat.html"><a href="comdat.html"><i class="fa fa-check"></i><b>17</b> Commercial Landings Data</a><ul>
<li class="chapter" data-level="17.1" data-path="comdat.html"><a href="comdat.html#methods-15"><i class="fa fa-check"></i><b>17.1</b> Methods</a><ul>
<li class="chapter" data-level="17.1.1" data-path="comdat.html"><a href="comdat.html#data-sources-15"><i class="fa fa-check"></i><b>17.1.1</b> Data sources</a></li>
<li class="chapter" data-level="17.1.2" data-path="comdat.html"><a href="comdat.html#data-extraction-13"><i class="fa fa-check"></i><b>17.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="17.1.3" data-path="comdat.html"><a href="comdat.html#data-analysis-14"><i class="fa fa-check"></i><b>17.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="17.1.4" data-path="comdat.html"><a href="comdat.html#plotting-10"><i class="fa fa-check"></i><b>17.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="long-term-sea-surface-temperature.html"><a href="long-term-sea-surface-temperature.html"><i class="fa fa-check"></i><b>18</b> Long-term Sea Surface Temperature</a><ul>
<li class="chapter" data-level="18.1" data-path="long-term-sea-surface-temperature.html"><a href="long-term-sea-surface-temperature.html#methods-16"><i class="fa fa-check"></i><b>18.1</b> Methods</a><ul>
<li class="chapter" data-level="18.1.1" data-path="long-term-sea-surface-temperature.html"><a href="long-term-sea-surface-temperature.html#data-sources-16"><i class="fa fa-check"></i><b>18.1.1</b> Data sources</a></li>
<li class="chapter" data-level="18.1.2" data-path="long-term-sea-surface-temperature.html"><a href="long-term-sea-surface-temperature.html#data-extraction-14"><i class="fa fa-check"></i><b>18.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="18.1.3" data-path="long-term-sea-surface-temperature.html"><a href="long-term-sea-surface-temperature.html#data-processing-10"><i class="fa fa-check"></i><b>18.1.3</b> Data Processing</a></li>
<li class="chapter" data-level="18.1.4" data-path="long-term-sea-surface-temperature.html"><a href="long-term-sea-surface-temperature.html#plotting-11"><i class="fa fa-check"></i><b>18.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="mid-atlantic-harmful-algal-bloom-indicator.html"><a href="mid-atlantic-harmful-algal-bloom-indicator.html"><i class="fa fa-check"></i><b>19</b> Mid-Atlantic Harmful Algal Bloom Indicator</a><ul>
<li class="chapter" data-level="19.1" data-path="mid-atlantic-harmful-algal-bloom-indicator.html"><a href="mid-atlantic-harmful-algal-bloom-indicator.html#methods-17"><i class="fa fa-check"></i><b>19.1</b> Methods</a><ul>
<li class="chapter" data-level="19.1.1" data-path="mid-atlantic-harmful-algal-bloom-indicator.html"><a href="mid-atlantic-harmful-algal-bloom-indicator.html#data-sources-17"><i class="fa fa-check"></i><b>19.1.1</b> Data sources</a></li>
<li class="chapter" data-level="19.1.2" data-path="mid-atlantic-harmful-algal-bloom-indicator.html"><a href="mid-atlantic-harmful-algal-bloom-indicator.html#data-extraction-15"><i class="fa fa-check"></i><b>19.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="19.1.3" data-path="mid-atlantic-harmful-algal-bloom-indicator.html"><a href="mid-atlantic-harmful-algal-bloom-indicator.html#data-analysis-15"><i class="fa fa-check"></i><b>19.1.3</b> Data analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="new-england-harmful-algal-bloom-indicator.html"><a href="new-england-harmful-algal-bloom-indicator.html"><i class="fa fa-check"></i><b>20</b> New England Harmful Algal Bloom Indicator</a><ul>
<li class="chapter" data-level="20.1" data-path="new-england-harmful-algal-bloom-indicator.html"><a href="new-england-harmful-algal-bloom-indicator.html#methods-18"><i class="fa fa-check"></i><b>20.1</b> Methods</a><ul>
<li class="chapter" data-level="20.1.1" data-path="new-england-harmful-algal-bloom-indicator.html"><a href="new-england-harmful-algal-bloom-indicator.html#data-sources-18"><i class="fa fa-check"></i><b>20.1.1</b> Data sources</a></li>
<li class="chapter" data-level="20.1.2" data-path="new-england-harmful-algal-bloom-indicator.html"><a href="new-england-harmful-algal-bloom-indicator.html#data-extraction-16"><i class="fa fa-check"></i><b>20.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="20.1.3" data-path="new-england-harmful-algal-bloom-indicator.html"><a href="new-england-harmful-algal-bloom-indicator.html#data-analysis-16"><i class="fa fa-check"></i><b>20.1.3</b> Data analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="verified-records-of-southern-kingfish.html"><a href="verified-records-of-southern-kingfish.html"><i class="fa fa-check"></i><b>21</b> Verified Records of Southern Kingfish</a><ul>
<li class="chapter" data-level="21.1" data-path="verified-records-of-southern-kingfish.html"><a href="verified-records-of-southern-kingfish.html#methods-19"><i class="fa fa-check"></i><b>21.1</b> Methods</a><ul>
<li class="chapter" data-level="21.1.1" data-path="verified-records-of-southern-kingfish.html"><a href="verified-records-of-southern-kingfish.html#data-sources-19"><i class="fa fa-check"></i><b>21.1.1</b> Data sources</a></li>
<li class="chapter" data-level="21.1.2" data-path="verified-records-of-southern-kingfish.html"><a href="verified-records-of-southern-kingfish.html#data-extraction-17"><i class="fa fa-check"></i><b>21.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="21.1.3" data-path="verified-records-of-southern-kingfish.html"><a href="verified-records-of-southern-kingfish.html#data-analysis-17"><i class="fa fa-check"></i><b>21.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="21.1.4" data-path="verified-records-of-southern-kingfish.html"><a href="verified-records-of-southern-kingfish.html#plotting-12"><i class="fa fa-check"></i><b>21.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="habitat-occupancy-models.html"><a href="habitat-occupancy-models.html"><i class="fa fa-check"></i><b>22</b> Habitat Occupancy Models</a><ul>
<li class="chapter" data-level="22.1" data-path="habitat-occupancy-models.html"><a href="habitat-occupancy-models.html#methods-20"><i class="fa fa-check"></i><b>22.1</b> Methods</a><ul>
<li class="chapter" data-level="22.1.1" data-path="habitat-occupancy-models.html"><a href="habitat-occupancy-models.html#data-sources-20"><i class="fa fa-check"></i><b>22.1.1</b> Data sources</a></li>
<li class="chapter" data-level="22.1.2" data-path="habitat-occupancy-models.html"><a href="habitat-occupancy-models.html#data-processing-11"><i class="fa fa-check"></i><b>22.1.2</b> Data processing</a></li>
<li class="chapter" data-level="22.1.3" data-path="habitat-occupancy-models.html"><a href="habitat-occupancy-models.html#data-analysis-18"><i class="fa fa-check"></i><b>22.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="22.1.4" data-path="habitat-occupancy-models.html"><a href="habitat-occupancy-models.html#plotting-13"><i class="fa fa-check"></i><b>22.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="fish-productivity-indicator.html"><a href="fish-productivity-indicator.html"><i class="fa fa-check"></i><b>23</b> Fish Productivity Indicator</a><ul>
<li class="chapter" data-level="23.1" data-path="fish-productivity-indicator.html"><a href="fish-productivity-indicator.html#methods-21"><i class="fa fa-check"></i><b>23.1</b> Methods</a><ul>
<li class="chapter" data-level="23.1.1" data-path="fish-productivity-indicator.html"><a href="fish-productivity-indicator.html#data-sources-21"><i class="fa fa-check"></i><b>23.1.1</b> Data sources</a></li>
<li class="chapter" data-level="23.1.2" data-path="fish-productivity-indicator.html"><a href="fish-productivity-indicator.html#data-extraction-18"><i class="fa fa-check"></i><b>23.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="23.1.3" data-path="fish-productivity-indicator.html"><a href="fish-productivity-indicator.html#data-analysis-19"><i class="fa fa-check"></i><b>23.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="23.1.4" data-path="fish-productivity-indicator.html"><a href="fish-productivity-indicator.html#data-processing-12"><i class="fa fa-check"></i><b>23.1.4</b> Data processing</a></li>
<li class="chapter" data-level="23.1.5" data-path="fish-productivity-indicator.html"><a href="fish-productivity-indicator.html#plotting-14"><i class="fa fa-check"></i><b>23.1.5</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="recreational-fishing-indicators.html"><a href="recreational-fishing-indicators.html"><i class="fa fa-check"></i><b>24</b> Recreational Fishing Indicators</a><ul>
<li class="chapter" data-level="24.1" data-path="recreational-fishing-indicators.html"><a href="recreational-fishing-indicators.html#methods-22"><i class="fa fa-check"></i><b>24.1</b> Methods</a><ul>
<li class="chapter" data-level="24.1.1" data-path="recreational-fishing-indicators.html"><a href="recreational-fishing-indicators.html#data-sources-22"><i class="fa fa-check"></i><b>24.1.1</b> Data sources</a></li>
<li class="chapter" data-level="24.1.2" data-path="recreational-fishing-indicators.html"><a href="recreational-fishing-indicators.html#data-analysis-20"><i class="fa fa-check"></i><b>24.1.2</b> Data analysis</a></li>
<li class="chapter" data-level="24.1.3" data-path="recreational-fishing-indicators.html"><a href="recreational-fishing-indicators.html#data-processing-13"><i class="fa fa-check"></i><b>24.1.3</b> Data processing</a></li>
<li class="chapter" data-level="24.1.4" data-path="recreational-fishing-indicators.html"><a href="recreational-fishing-indicators.html#plotting-15"><i class="fa fa-check"></i><b>24.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="right-whale-abundance.html"><a href="right-whale-abundance.html"><i class="fa fa-check"></i><b>25</b> Right Whale Abundance</a><ul>
<li class="chapter" data-level="25.1" data-path="right-whale-abundance.html"><a href="right-whale-abundance.html#methods-23"><i class="fa fa-check"></i><b>25.1</b> Methods</a><ul>
<li class="chapter" data-level="25.1.1" data-path="right-whale-abundance.html"><a href="right-whale-abundance.html#data-sources-23"><i class="fa fa-check"></i><b>25.1.1</b> Data sources</a></li>
<li class="chapter" data-level="25.1.2" data-path="right-whale-abundance.html"><a href="right-whale-abundance.html#data-extraction-19"><i class="fa fa-check"></i><b>25.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="25.1.3" data-path="right-whale-abundance.html"><a href="right-whale-abundance.html#data-analysis-21"><i class="fa fa-check"></i><b>25.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="25.1.4" data-path="right-whale-abundance.html"><a href="right-whale-abundance.html#data-processing-14"><i class="fa fa-check"></i><b>25.1.4</b> Data processing</a></li>
<li class="chapter" data-level="25.1.5" data-path="right-whale-abundance.html"><a href="right-whale-abundance.html#plotting-16"><i class="fa fa-check"></i><b>25.1.5</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="seabird-diet-and-productivity.html"><a href="seabird-diet-and-productivity.html"><i class="fa fa-check"></i><b>26</b> Seabird diet and productivity</a><ul>
<li class="chapter" data-level="26.1" data-path="seabird-diet-and-productivity.html"><a href="seabird-diet-and-productivity.html#methods-24"><i class="fa fa-check"></i><b>26.1</b> Methods</a><ul>
<li class="chapter" data-level="26.1.1" data-path="seabird-diet-and-productivity.html"><a href="seabird-diet-and-productivity.html#data-sources-24"><i class="fa fa-check"></i><b>26.1.1</b> Data sources</a></li>
<li class="chapter" data-level="26.1.2" data-path="seabird-diet-and-productivity.html"><a href="seabird-diet-and-productivity.html#data-processing-15"><i class="fa fa-check"></i><b>26.1.2</b> Data processing</a></li>
<li class="chapter" data-level="26.1.3" data-path="seabird-diet-and-productivity.html"><a href="seabird-diet-and-productivity.html#data-analysis-22"><i class="fa fa-check"></i><b>26.1.3</b> Data analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="seasonal-sst-anomalies.html"><a href="seasonal-sst-anomalies.html"><i class="fa fa-check"></i><b>27</b> Seasonal SST Anomalies</a><ul>
<li class="chapter" data-level="27.1" data-path="seasonal-sst-anomalies.html"><a href="seasonal-sst-anomalies.html#methods-25"><i class="fa fa-check"></i><b>27.1</b> Methods</a><ul>
<li class="chapter" data-level="27.1.1" data-path="seasonal-sst-anomalies.html"><a href="seasonal-sst-anomalies.html#data-sources-25"><i class="fa fa-check"></i><b>27.1.1</b> Data sources</a></li>
<li class="chapter" data-level="27.1.2" data-path="seasonal-sst-anomalies.html"><a href="seasonal-sst-anomalies.html#data-extraction-20"><i class="fa fa-check"></i><b>27.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="27.1.3" data-path="seasonal-sst-anomalies.html"><a href="seasonal-sst-anomalies.html#data-analysis-23"><i class="fa fa-check"></i><b>27.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="27.1.4" data-path="seasonal-sst-anomalies.html"><a href="seasonal-sst-anomalies.html#plotting-17"><i class="fa fa-check"></i><b>27.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="stockstatus.html"><a href="stockstatus.html"><i class="fa fa-check"></i><b>28</b> Single Species Status Indicator</a><ul>
<li class="chapter" data-level="28.1" data-path="stockstatus.html"><a href="stockstatus.html#methods-26"><i class="fa fa-check"></i><b>28.1</b> Methods</a><ul>
<li class="chapter" data-level="28.1.1" data-path="stockstatus.html"><a href="stockstatus.html#data-sources-26"><i class="fa fa-check"></i><b>28.1.1</b> Data sources</a></li>
<li class="chapter" data-level="28.1.2" data-path="stockstatus.html"><a href="stockstatus.html#data-extraction-21"><i class="fa fa-check"></i><b>28.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="28.1.3" data-path="stockstatus.html"><a href="stockstatus.html#data-processing-16"><i class="fa fa-check"></i><b>28.1.3</b> Data processing</a></li>
<li class="chapter" data-level="28.1.4" data-path="stockstatus.html"><a href="stockstatus.html#data-analysis-24"><i class="fa fa-check"></i><b>28.1.4</b> Data analysis</a></li>
<li class="chapter" data-level="28.1.5" data-path="stockstatus.html"><a href="stockstatus.html#plotting-18"><i class="fa fa-check"></i><b>28.1.5</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="species-density-estimates.html"><a href="species-density-estimates.html"><i class="fa fa-check"></i><b>29</b> Species Density Estimates</a><ul>
<li class="chapter" data-level="29.1" data-path="species-density-estimates.html"><a href="species-density-estimates.html#methods-27"><i class="fa fa-check"></i><b>29.1</b> Methods</a><ul>
<li class="chapter" data-level="29.1.1" data-path="species-density-estimates.html"><a href="species-density-estimates.html#data-sources-27"><i class="fa fa-check"></i><b>29.1.1</b> Data sources</a></li>
<li class="chapter" data-level="29.1.2" data-path="species-density-estimates.html"><a href="species-density-estimates.html#data-analysis-25"><i class="fa fa-check"></i><b>29.1.2</b> Data analysis</a></li>
<li class="chapter" data-level="29.1.3" data-path="species-density-estimates.html"><a href="species-density-estimates.html#plotting-19"><i class="fa fa-check"></i><b>29.1.3</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="species-distribution-indicators.html"><a href="species-distribution-indicators.html"><i class="fa fa-check"></i><b>30</b> Species Distribution Indicators</a><ul>
<li class="chapter" data-level="30.1" data-path="species-distribution-indicators.html"><a href="species-distribution-indicators.html#methods-28"><i class="fa fa-check"></i><b>30.1</b> Methods</a><ul>
<li class="chapter" data-level="30.1.1" data-path="species-distribution-indicators.html"><a href="species-distribution-indicators.html#data-sources-28"><i class="fa fa-check"></i><b>30.1.1</b> Data sources</a></li>
<li class="chapter" data-level="30.1.2" data-path="species-distribution-indicators.html"><a href="species-distribution-indicators.html#data-analysis-26"><i class="fa fa-check"></i><b>30.1.2</b> Data analysis</a></li>
<li class="chapter" data-level="30.1.3" data-path="species-distribution-indicators.html"><a href="species-distribution-indicators.html#data-processing-17"><i class="fa fa-check"></i><b>30.1.3</b> Data processing</a></li>
<li class="chapter" data-level="30.1.4" data-path="species-distribution-indicators.html"><a href="species-distribution-indicators.html#plotting-20"><i class="fa fa-check"></i><b>30.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="survdat.html"><a href="survdat.html"><i class="fa fa-check"></i><b>31</b> Survey Data</a><ul>
<li class="chapter" data-level="31.1" data-path="survdat.html"><a href="survdat.html#methods-29"><i class="fa fa-check"></i><b>31.1</b> Methods</a><ul>
<li class="chapter" data-level="31.1.1" data-path="survdat.html"><a href="survdat.html#data-sources-29"><i class="fa fa-check"></i><b>31.1.1</b> Data sources</a></li>
<li class="chapter" data-level="31.1.2" data-path="survdat.html"><a href="survdat.html#data-extraction-22"><i class="fa fa-check"></i><b>31.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="31.1.3" data-path="survdat.html"><a href="survdat.html#data-analysis-27"><i class="fa fa-check"></i><b>31.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="31.1.4" data-path="survdat.html"><a href="survdat.html#plotting-21"><i class="fa fa-check"></i><b>31.1.4</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="thermal-habitat-projections.html"><a href="thermal-habitat-projections.html"><i class="fa fa-check"></i><b>32</b> Thermal Habitat Projections</a><ul>
<li class="chapter" data-level="32.1" data-path="thermal-habitat-projections.html"><a href="thermal-habitat-projections.html#methods-30"><i class="fa fa-check"></i><b>32.1</b> Methods</a><ul>
<li class="chapter" data-level="32.1.1" data-path="thermal-habitat-projections.html"><a href="thermal-habitat-projections.html#data-sources-30"><i class="fa fa-check"></i><b>32.1.1</b> Data sources</a></li>
<li class="chapter" data-level="32.1.2" data-path="thermal-habitat-projections.html"><a href="thermal-habitat-projections.html#data-analysis-28"><i class="fa fa-check"></i><b>32.1.2</b> Data analysis</a></li>
<li class="chapter" data-level="32.1.3" data-path="thermal-habitat-projections.html"><a href="thermal-habitat-projections.html#plotting-22"><i class="fa fa-check"></i><b>32.1.3</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="33" data-path="trend-analysis.html"><a href="trend-analysis.html"><i class="fa fa-check"></i><b>33</b> Trend Analysis</a><ul>
<li class="chapter" data-level="33.1" data-path="trend-analysis.html"><a href="trend-analysis.html#methods-31"><i class="fa fa-check"></i><b>33.1</b> Methods</a><ul>
<li class="chapter" data-level="33.1.1" data-path="trend-analysis.html"><a href="trend-analysis.html#data-sources-31"><i class="fa fa-check"></i><b>33.1.1</b> Data source(s)</a></li>
<li class="chapter" data-level="33.1.2" data-path="trend-analysis.html"><a href="trend-analysis.html#data-extraction-23"><i class="fa fa-check"></i><b>33.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="33.1.3" data-path="trend-analysis.html"><a href="trend-analysis.html#data-analysis-29"><i class="fa fa-check"></i><b>33.1.3</b> Data analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="34" data-path="zooabund.html"><a href="zooabund.html"><i class="fa fa-check"></i><b>34</b> Zooplankton</a><ul>
<li class="chapter" data-level="34.1" data-path="zooabund.html"><a href="zooabund.html#methods-32"><i class="fa fa-check"></i><b>34.1</b> Methods</a><ul>
<li class="chapter" data-level="34.1.1" data-path="zooabund.html"><a href="zooabund.html#data-sources-32"><i class="fa fa-check"></i><b>34.1.1</b> Data sources</a></li>
<li class="chapter" data-level="34.1.2" data-path="zooabund.html"><a href="zooabund.html#data-extraction-24"><i class="fa fa-check"></i><b>34.1.2</b> Data extraction</a></li>
<li class="chapter" data-level="34.1.3" data-path="zooabund.html"><a href="zooabund.html#data-analysis-30"><i class="fa fa-check"></i><b>34.1.3</b> Data analysis</a></li>
<li class="chapter" data-level="34.1.4" data-path="zooabund.html"><a href="zooabund.html#data-processing-18"><i class="fa fa-check"></i><b>34.1.4</b> Data processing</a></li>
<li class="chapter" data-level="34.1.5" data-path="zooabund.html"><a href="zooabund.html#plotting-23"><i class="fa fa-check"></i><b>34.1.5</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/NOAA-EDAB/tech-doc" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Technical Documentation, State of the Ecosystem Report</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trend-analysis" class="section level1">
<h1><span class="header-section-number">33</span> Trend Analysis</h1>
<p><strong>Description</strong>: Time series trend analysis</p>
<p><strong>Found in</strong>: State of the Ecosystem - Gulf of Maine &amp; Georges Bank (2018, 2019), State of the Ecosystem - Mid-Atlantic (2018, 2019)</p>
<p><strong>Indicator category</strong>: Extensive analysis, not yet published</p>
<p><strong>Contributor(s)</strong>: Sean Hardison, Charles Perretti, Geret DePiper</p>
<p><strong>Data steward</strong>: NA</p>
<p><strong>Point of contact</strong>: Sean Hardison, <a href="mailto:sean.hardison@noaa.gov">sean.hardison@noaa.gov</a></p>
<p><strong>Public availability statement</strong>: NA</p>
<div id="methods-31" class="section level2">
<h2><span class="header-section-number">33.1</span> Methods</h2>
<p>Summarizing trends for ecosystem indicators is desirable, but the power of statistical tests to detect a trend is hampered by low sample size and autocorrelated observations <span class="citation">(see Nicholson and Jennings <a href="#ref-Nicholson2004">2004</a>; Wagner et al. <a href="#ref-Wagner2013">2013</a>; Storch <a href="#ref-VonStorch1999a">1999</a>)</span>. Prior to 2018, time series indicators in State of the Ecosystem reports were presented with trend lines based on a Mann-Kendall test for monotonic trends to test significance (p &lt; 0.05) of both long term (full time series) and recent (2007–2016) trends, although not all time series were considered for trend analysis due to limited series lengths. There was also concern that a Mann-Kendall test would not account for any autocorrelation present in SOE indicators.</p>
<p>In a simulation study <span class="citation">(Hardison et al. <a href="#ref-hardison2019">2019</a>)</span>, we explored the effect of time series length and autocorrelation strength on statistical power of three trend detection methods: a generalized least squares model selection approach, the Mann-Kendall test, and Mann-Kendall test with trend-free pre-whitening. Methods were applied to simulated time series of varying trend and autocorrelation strengths. Overall, when sample size was low (N = 10) there were high rates of false trend detection, and similarly, low rates of true trend detection. Both of these forms of error were further amplified by autocorrelation in the trend residuals. Based on these findings, we selected a minimum series length of N = 30 for indicator time series before assessing trend.</p>
<p>We also chose to use a GLS model selection (GLS-MS) approach to evaluate indicator trends in the 2018 (and future) State of the Ecosystem reports, as this approach performed best overall in the simulation study. GLS-MS also allowed for both linear and quadratic model fits and quantification of uncertainty in trend estimates. The model selection procedure for the GLS approach fits four models to each time series and selects the best fitting model using AICc. The models are, 1) linear trend with uncorrelated residuals, 2) linear trend with correlated residuals, 3) quadratic trend with uncorrelated residuals, and 4) quadratic trend with correlated residuals. I.e., the models are of the form</p>
<p><span class="math display">\[ Y_t = \alpha_0 + \alpha_1X_t + \alpha_2X_t^2 + \epsilon_t\]</span> <span class="math display">\[\epsilon_t = \rho\epsilon_{t-1} + \omega_t\]</span></p>
<p><span class="math display">\[w_t \sim N(0, \sigma^2)\]</span></p>
<p>Where <span class="math inline">\(Y_t\)</span> is the observation in time <span class="math inline">\(t\)</span>, <span class="math inline">\(X_t\)</span> is the time index, <span class="math inline">\(\epsilon_t\)</span> is the residual in time <span class="math inline">\(t\)</span>, and <span class="math inline">\(\omega_t\)</span> is a normally distributed random variable. Setting <span class="math inline">\(\alpha_2 = 0\)</span> yields the linear trend model, and <span class="math inline">\(\rho = 0\)</span> yields the uncorrelated residuals model.</p>
<p>The best fit model was tested against the null hypothesis of no trend through a likelihood ratio test (p &lt; 0.05). All models were fit using the R package <em>nlme</em> <span class="citation">(Pinheiro et al. <a href="#ref-Pinheiro2017">2017</a>)</span> and AICc was calculated using the R package <em>AICcmodavg</em> <span class="citation">(Mazerolle <a href="#ref-Mazerolle2017a">2017</a>)</span>. In SOE time series figures, significant positive trends were colored orange, and negative trends purple.</p>
<div id="data-sources-31" class="section level3">
<h3><span class="header-section-number">33.1.1</span> Data source(s)</h3>
<p>NA</p>
</div>
<div id="data-extraction-23" class="section level3">
<h3><span class="header-section-number">33.1.2</span> Data extraction</h3>
<p>NA</p>
</div>
<div id="data-analysis-29" class="section level3">
<h3><span class="header-section-number">33.1.3</span> Data analysis</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#R packages</span>
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(nlme)
<span class="kw">library</span>(AICcmodavg)
<span class="kw">library</span>(data.table)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># data.dir &lt;- &quot;./data&quot;</span>
<span class="co"># load(file.path(data.dir, &quot;SOE_data_2018.Rdata&quot;))</span>

<span class="co">#--------------------------------GLS Model Selection-----------------------------#</span>
fit_lm &lt;-<span class="st"> </span><span class="cf">function</span>(dat) {

  constant_norm &lt;-
<span class="st">    </span>nlme<span class="op">::</span><span class="kw">gls</span>(series <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, 
              <span class="dt">data =</span> dat)
  
  constant_ar1 &lt;-
<span class="st">    </span><span class="kw">try</span>(nlme<span class="op">::</span><span class="kw">gls</span>(series <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,
                  <span class="dt">data =</span> dat,
                  <span class="dt">correlation =</span> nlme<span class="op">::</span><span class="kw">corAR1</span>(<span class="dt">form =</span> <span class="op">~</span>time)))
  <span class="cf">if</span> (<span class="kw">class</span>(constant_ar1) <span class="op">==</span><span class="st"> &quot;try-error&quot;</span>){
    <span class="kw">return</span>(best_lm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">model =</span> <span class="ot">NA</span>,
                                 <span class="dt">aicc  =</span> <span class="ot">NA</span>,
                                 <span class="dt">coefs..Intercept =</span> <span class="ot">NA</span>,
                                 <span class="dt">coefs.time =</span> <span class="ot">NA</span>,
                                 <span class="dt">coefs.time2 =</span> <span class="ot">NA</span>,
                                 <span class="dt">pval =</span> <span class="ot">NA</span>)) 
  } 
  
  
  
  <span class="co"># Linear model with normal error</span>
  linear_norm &lt;-<span class="st"> </span>
<span class="st">    </span>nlme<span class="op">::</span><span class="kw">gls</span>(series <span class="op">~</span><span class="st"> </span>time, 
              <span class="dt">data =</span> dat)
  
  <span class="co"># Linear model with AR1 error</span>
  linear_ar1 &lt;-<span class="st"> </span>
<span class="st">    </span><span class="kw">try</span>(nlme<span class="op">::</span><span class="kw">gls</span>(series <span class="op">~</span><span class="st"> </span>time, 
                  <span class="dt">data =</span> dat,
                  <span class="dt">correlation =</span> nlme<span class="op">::</span><span class="kw">corAR1</span>(<span class="dt">form =</span> <span class="op">~</span>time)))
  <span class="cf">if</span> (<span class="kw">class</span>(linear_ar1) <span class="op">==</span><span class="st"> &quot;try-error&quot;</span>){
    <span class="kw">return</span>(best_lm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">model =</span> <span class="ot">NA</span>,
                                 <span class="dt">aicc  =</span> <span class="ot">NA</span>,
                                 <span class="dt">coefs..Intercept =</span> <span class="ot">NA</span>,
                                 <span class="dt">coefs.time =</span> <span class="ot">NA</span>,
                                 <span class="dt">coefs.time2 =</span> <span class="ot">NA</span>,
                                 <span class="dt">pval =</span> <span class="ot">NA</span>))
    
  }
  
  <span class="co"># Polynomial model with normal error</span>
  dat<span class="op">$</span>time2 &lt;-<span class="st"> </span>dat<span class="op">$</span>time<span class="op">^</span><span class="dv">2</span>
  poly_norm &lt;-<span class="st"> </span>
<span class="st">    </span>nlme<span class="op">::</span><span class="kw">gls</span>(series <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>time2, 
              <span class="dt">data =</span> dat)
  
  <span class="co"># Polynomial model with AR1 error</span>
  poly_ar1 &lt;-<span class="st"> </span>
<span class="st">    </span><span class="kw">try</span>(nlme<span class="op">::</span><span class="kw">gls</span>(series <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>time2, 
                  <span class="dt">data =</span> dat,
                  <span class="dt">correlation =</span> nlme<span class="op">::</span><span class="kw">corAR1</span>(<span class="dt">form =</span> <span class="op">~</span>time)))
  <span class="cf">if</span> (<span class="kw">class</span>(poly_ar1) <span class="op">==</span><span class="st"> &quot;try-error&quot;</span>){
    <span class="kw">return</span>(best_lm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">model =</span> <span class="ot">NA</span>,
                                 <span class="dt">aicc  =</span> <span class="ot">NA</span>,
                                 <span class="dt">coefs..Intercept =</span> <span class="ot">NA</span>,
                                 <span class="dt">coefs.time =</span> <span class="ot">NA</span>,
                                 <span class="dt">coefs.time2 =</span> <span class="ot">NA</span>,
                                 <span class="dt">pval =</span> <span class="ot">NA</span>))
    
  }
  
  <span class="co"># Calculate AICs for all models</span>
  df_aicc &lt;-
<span class="st">    </span><span class="kw">data.frame</span>(<span class="dt">model =</span> <span class="kw">c</span>(<span class="st">&quot;poly_norm&quot;</span>,
                         <span class="st">&quot;poly_ar1&quot;</span>,
                         <span class="st">&quot;linear_norm&quot;</span>,
                         <span class="st">&quot;linear_ar1&quot;</span>),
               <span class="dt">aicc  =</span> <span class="kw">c</span>(<span class="kw">AICc</span>(poly_norm),
                         <span class="kw">AICc</span>(poly_ar1),
                         <span class="kw">AICc</span>(linear_norm),
                         <span class="kw">AICc</span>(linear_ar1)),
               <span class="dt">coefs =</span> <span class="kw">rbind</span>(<span class="kw">coef</span>(poly_norm),
                             <span class="kw">coef</span>(poly_ar1),
                             <span class="kw">c</span>(<span class="kw">coef</span>(linear_norm), <span class="ot">NA</span>),
                             <span class="kw">c</span>(<span class="kw">coef</span>(linear_ar1),  <span class="ot">NA</span>)),
               <span class="co"># Calculate overall signifiance (need to use</span>
               <span class="co"># ML not REML for this)</span>
               <span class="dt">pval =</span> <span class="kw">c</span>(<span class="kw">anova</span>(<span class="kw">update</span>(constant_norm, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>),
                              <span class="kw">update</span>(poly_norm, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>))<span class="op">$</span><span class="st">`</span><span class="dt">p-value</span><span class="st">`</span>[<span class="dv">2</span>],
                        <span class="kw">anova</span>(<span class="kw">update</span>(constant_ar1, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>),
                              <span class="kw">update</span>(poly_ar1, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>))<span class="op">$</span><span class="st">`</span><span class="dt">p-value</span><span class="st">`</span>[<span class="dv">2</span>],
                        <span class="kw">anova</span>(<span class="kw">update</span>(constant_norm, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>),
                              <span class="kw">update</span>(linear_norm, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>))<span class="op">$</span><span class="st">`</span><span class="dt">p-value</span><span class="st">`</span>[<span class="dv">2</span>],
                        <span class="kw">anova</span>(<span class="kw">update</span>(constant_ar1, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>),
                              <span class="kw">update</span>(linear_ar1, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>))<span class="op">$</span><span class="st">`</span><span class="dt">p-value</span><span class="st">`</span>[<span class="dv">2</span>]))
  
  best_lm &lt;-
<span class="st">    </span>df_aicc <span class="op">%&gt;%</span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(aicc <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(aicc))
  
  
  <span class="cf">if</span> (best_lm<span class="op">$</span>model <span class="op">==</span><span class="st"> &quot;poly_norm&quot;</span>) {
    model &lt;-<span class="st"> </span>poly_norm
  } <span class="cf">else</span> <span class="cf">if</span> (best_lm<span class="op">$</span>model <span class="op">==</span><span class="st"> &quot;poly_ar1&quot;</span>) {
    model &lt;-<span class="st"> </span>poly_ar1
  } <span class="cf">else</span> <span class="cf">if</span> (best_lm<span class="op">$</span>model <span class="op">==</span><span class="st"> &quot;linear_norm&quot;</span>) {
    model &lt;-<span class="st"> </span>linear_norm
  } <span class="cf">else</span> <span class="cf">if</span> (best_lm<span class="op">$</span>model <span class="op">==</span><span class="st"> &quot;linear_ar1&quot;</span>) {
    model &lt;-<span class="st"> </span>linear_ar1
  }
  
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">p =</span> best_lm<span class="op">$</span>pval,
              <span class="dt">model =</span> model))
}

<span class="co">#-------------------------------------Plotting code------------------------------------#</span>
soe.plot &lt;-<span class="st"> </span><span class="cf">function</span>(data, x.var, y.var, <span class="dt">x.label =</span> <span class="st">&#39;&#39;</span>, <span class="dt">y.label =</span> <span class="st">&#39;&#39;</span>, <span class="dt">tol =</span> <span class="fl">0.1</span>,
                     <span class="dt">x.start =</span> <span class="ot">NA</span>, <span class="dt">x.end =</span> <span class="ot">NA</span>, <span class="dt">end.start =</span> <span class="dv">2008</span>, <span class="dt">bg.col =</span> background, <span class="dt">mean_line =</span> T,
                     <span class="dt">end.col =</span> recent, <span class="dt">stacked =</span> <span class="ot">NA</span>, <span class="dt">x.line =</span> <span class="fl">2.5</span>, <span class="dt">y.line =</span> <span class="fl">3.5</span>, <span class="dt">scale.axis =</span> <span class="dv">1</span>,
                     <span class="dt">rel.y.num =</span> <span class="fl">1.5</span>, <span class="dt">rel.y.text =</span> <span class="fl">1.5</span>, <span class="dt">suppressAxis =</span> <span class="ot">FALSE</span>,<span class="dt">status  =</span> F,<span class="dt">anomaly =</span> F,
                     <span class="dt">endshade =</span> <span class="ot">TRUE</span>, <span class="dt">full.trend =</span> <span class="ot">TRUE</span>, <span class="dt">point.cex =</span> <span class="fl">1.5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">ymax =</span> <span class="ot">TRUE</span>,<span class="dt">ymin =</span> <span class="ot">TRUE</span>,
                     <span class="dt">y.upper =</span> y.upper, <span class="dt">y.lower =</span> y.lower, <span class="dt">extra =</span> <span class="ot">FALSE</span>, <span class="dt">x.var2 =</span> x.var2, <span class="dt">y.var2 =</span> y.var2,
                     <span class="dt">line.forward =</span> <span class="ot">FALSE</span>, <span class="dt">mean_line.2 =</span> T, <span class="dt">cex.stacked =</span> <span class="dv">1</span>, <span class="dt">website =</span> T) {
  

  <span class="co">#Select Data</span>
  x &lt;-<span class="st"> </span>data[Var <span class="op">==</span><span class="st"> </span>y.var, ]
  x &lt;-<span class="st"> </span>x[<span class="kw">order</span>(x[, <span class="kw">get</span>(x.var)]), ]
  <span class="kw">setnames</span>(x, x.var, <span class="st">&#39;X&#39;</span>)
  
  <span class="co">#Set common time step if necessary</span>
  <span class="cf">if</span>(<span class="kw">is.na</span>(x.start)) x.start &lt;-<span class="st"> </span><span class="kw">min</span>(x[, X])
  <span class="cf">if</span>(<span class="kw">is.na</span>(x.end))   x.end   &lt;-<span class="st"> </span><span class="kw">max</span>(x[, X])
  x &lt;-<span class="st"> </span>x[X <span class="op">&gt;=</span><span class="st"> </span>x.start, ]
  
  <span class="co">#Set up plot parameters</span>
  <span class="cf">if</span> (ymax <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
    y.max &lt;-<span class="st"> </span><span class="kw">max</span>(x[, Value]) <span class="op">+</span><span class="st"> </span>tol <span class="op">*</span><span class="st"> </span><span class="kw">max</span>(x[, Value])
  } <span class="cf">else</span> {
    y.max &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(y.upper)
  }
  
  <span class="cf">if</span> (ymin <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
    y.min &lt;-<span class="st"> </span><span class="kw">min</span>(x[, Value]) <span class="op">-</span><span class="st"> </span>tol <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(<span class="kw">min</span>(x[, Value]))
  } <span class="cf">else</span> <span class="cf">if</span> (ymin <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>){
    y.min &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(y.lower)
  }
  
  y.mean &lt;-<span class="st"> </span><span class="kw">mean</span>(x[, Value])
  y.sd &lt;-<span class="st"> </span><span class="kw">sd</span>(x[, Value])
  
  <span class="co">#Plot blank plot</span>
  <span class="kw">plot</span>(x[X <span class="op">&gt;=</span><span class="st"> </span>x.start, <span class="kw">list</span>(X, Var)], <span class="dt">xlim =</span> <span class="kw">c</span>(x.start, x.end),
       <span class="dt">ylim =</span> <span class="kw">c</span>(y.min,y.max), <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">axes =</span> F, <span class="dt">ty =</span> <span class="st">&#39;n&#39;</span>)


  <span class="co">#Add background</span>
  u &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&#39;usr&#39;</span>)
  <span class="kw">rect</span>(u[<span class="dv">1</span>], u[<span class="dv">3</span>], u[<span class="dv">2</span>], u[<span class="dv">4</span>], <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">col =</span> bg.col)
  
  <span class="co">#Add end period shading</span>
  <span class="cf">if</span> (endshade <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
    <span class="kw">rect</span>(end.start <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>, u[<span class="dv">3</span>], u[<span class="dv">2</span>], u[<span class="dv">4</span>], <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">col =</span> end.col)
  }
  
  <span class="co">#Add mean line</span>
  <span class="cf">if</span> (anomaly <span class="op">==</span><span class="st"> </span>F){
      <span class="cf">if</span> (mean_line <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
      <span class="kw">abline</span>(<span class="dt">h =</span> y.mean, <span class="dt">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
      } 
  } <span class="cf">else</span> <span class="cf">if</span> (anomaly <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
      <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
  }
  
  <span class="co">#Add x y lines</span>
  <span class="kw">abline</span>(<span class="dt">h =</span> u[<span class="dv">3</span>], <span class="dt">lwd=</span><span class="dv">3</span>)
  <span class="kw">abline</span>(<span class="dt">v =</span> u[<span class="dv">1</span>], <span class="dt">lwd=</span><span class="dv">3</span>)
  
  <span class="co">#Add data points/lines</span>
  <span class="kw">points</span>(x[, <span class="kw">list</span>(X, Value)], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> point.cex)
  <span class="kw">lines</span>( x[, <span class="kw">list</span>(X, Value)], <span class="dt">lwd =</span> lwd)
  
  <span class="co">#extra lines</span>
  <span class="cf">if</span> (extra <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
    x2 &lt;-<span class="st"> </span>data[Var <span class="op">==</span><span class="st"> </span>y.var2, ]
    x2 &lt;-<span class="st"> </span>x2[<span class="kw">order</span>(x2[, <span class="kw">get</span>(x.var2)]), ]
    <span class="kw">setnames</span>(x2, x.var2, <span class="st">&#39;X2&#39;</span>)
    x2 &lt;-<span class="st"> </span>x2[X2 <span class="op">&gt;=</span><span class="st"> </span>x.start, ]
    <span class="cf">if</span> (mean_line.<span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">mean</span>(x2[, Value]), <span class="dt">col =</span> <span class="st">&#39;lightcoral&#39;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">2</span>) 
    }
    <span class="kw">points</span>(x2[, <span class="kw">list</span>(X2, Value)], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> point.cex, <span class="dt">col =</span> <span class="st">&quot;indianred&quot;</span>)
    <span class="kw">lines</span>( x2[, <span class="kw">list</span>(X2, Value)], <span class="dt">lwd =</span> lwd, <span class="dt">col =</span> <span class="st">&quot;indianred&quot;</span>)
    }
    
  
  <span class="co">#Add axis</span>
  <span class="cf">if</span> (suppressAxis <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>){
    <span class="cf">if</span>(<span class="kw">is.na</span>(stacked)) <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">cex.axis =</span> <span class="dv">1</span>)
    <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.na</span>(stacked)){
      <span class="cf">if</span>(stacked<span class="op">!=</span><span class="st"> &#39;A&#39;</span>) <span class="kw">axis</span>(<span class="dv">3</span>, <span class="dt">cex.axis =</span> <span class="fl">1.5</span>, <span class="dt">tck =</span> <span class="fl">0.1</span>, <span class="dt">labels =</span> F)
    }
  }

  <span class="co">#Stacked axes with 0 overlap so need to remove</span>
  labels &lt;-<span class="st"> </span><span class="kw">round</span>((<span class="kw">axTicks</span>(<span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>scale.axis), <span class="dv">5</span>)
  <span class="cf">if</span>(labels[<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) labels[<span class="dv">1</span>] &lt;-<span class="st"> &#39;&#39;</span>
  <span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">axTicks</span>(<span class="dv">2</span>), <span class="dt">labels =</span> labels, <span class="dt">cex.axis =</span> rel.y.num,
       <span class="dt">las =</span> T)

    <span class="co">#Add axis labels</span>
    <span class="cf">if</span>(<span class="op">!</span>website){
      <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.na</span>(stacked)) <span class="kw">text</span>(u[<span class="dv">1</span>], u[<span class="dv">4</span>], <span class="dt">labels =</span> stacked, <span class="dt">cex =</span> cex.stacked, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>))
    } <span class="cf">else</span> <span class="cf">if</span> (website){
      <span class="kw">text</span>(u[<span class="dv">1</span>], u[<span class="dv">4</span>], <span class="dt">labels =</span> <span class="st">&quot;&quot;</span>, <span class="dt">cex =</span> cex.stacked, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>))
    }
    <span class="cf">if</span>(<span class="kw">is.na</span>(stacked)){
      <span class="kw">mtext</span>(<span class="dv">1</span>, <span class="dt">text =</span> x.label, <span class="dt">line =</span> x.line, <span class="dt">cex =</span> <span class="dv">1</span>)
      <span class="kw">mtext</span>(<span class="dv">2</span>, <span class="dt">text =</span> y.label, <span class="dt">line =</span> y.line, <span class="dt">cex =</span> rel.y.text)
    }
  
    <span class="cf">if</span> (full.trend <span class="op">==</span><span class="st"> </span>T){
    <span class="co">#Split data into past decade and full time series</span>
    dat &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(x[, <span class="kw">list</span>(X, Value)])
    
    dat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">series =</span> Value) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">mutate</span>(<span class="dt">time =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="kw">nrow</span>(dat),<span class="dv">1</span>))
    
    <span class="co"># Fit linear model</span>
    lm_out &lt;-<span class="st"> </span><span class="kw">fit_lm</span>(<span class="dt">dat =</span> dat)
    p &lt;-<span class="st"> </span>lm_out<span class="op">$</span>p
    <span class="cf">if</span> (p <span class="op">&lt;</span><span class="st"> </span>.<span class="dv">05</span>){
        
      newtime &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>time), <span class="kw">max</span>(dat<span class="op">$</span>time), <span class="dt">length.out=</span><span class="kw">length</span>(dat<span class="op">$</span>time))
      newdata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> newtime,
                      <span class="dt">time2 =</span> newtime<span class="op">^</span><span class="dv">2</span>)
      lm_pred &lt;-<span class="st"> </span>AICcmodavg<span class="op">::</span><span class="kw">predictSE</span>(lm_out<span class="op">$</span>model, 
                                 <span class="dt">newdata =</span> newdata,
                                 <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)

      year &lt;-<span class="st"> </span><span class="kw">seq</span>(x<span class="op">$</span>X[<span class="dv">1</span>],x<span class="op">$</span>X[<span class="kw">length</span>(x<span class="op">$</span>X)],<span class="dt">length.out =</span> <span class="kw">length</span>(dat<span class="op">$</span>time))

      <span class="co"># Make plot</span>
      <span class="cf">if</span> (lm_pred<span class="op">$</span>fit[<span class="kw">length</span>(lm_pred<span class="op">$</span>fit)] <span class="op">&gt;</span><span class="st"> </span>lm_pred<span class="op">$</span>fit[<span class="dv">1</span>]){
        <span class="kw">lines</span>(year, lm_pred<span class="op">$</span>fit, <span class="dt">col =</span> main.pos, <span class="dt">lwd =</span> <span class="dv">7</span>)
        <span class="kw">points</span>(x[, <span class="kw">list</span>(X, Value)], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> point.cex)
        <span class="kw">lines</span>( x[, <span class="kw">list</span>(X, Value)], <span class="dt">lwd =</span> lwd)

        <span class="cf">if</span> (line.forward <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
           <span class="kw">lines</span>(year, lm_pred<span class="op">$</span>fit, <span class="dt">col =</span> main.pos, <span class="dt">lwd =</span> <span class="dv">7</span>)
        }
      } <span class="cf">else</span> <span class="cf">if</span> (lm_pred<span class="op">$</span>fit[<span class="kw">length</span>(lm_pred<span class="op">$</span>fit)] <span class="op">&lt;</span><span class="st"> </span>lm_pred<span class="op">$</span>fit[<span class="dv">1</span>]){
        <span class="kw">lines</span>(year, lm_pred<span class="op">$</span>fit, <span class="dt">col =</span> main.neg, <span class="dt">lwd =</span> <span class="dv">7</span>)
        <span class="kw">points</span>(x[, <span class="kw">list</span>(X, Value)], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> point.cex)
        <span class="kw">lines</span>( x[, <span class="kw">list</span>(X, Value)], <span class="dt">lwd =</span> lwd)
        <span class="cf">if</span> (line.forward <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
           <span class="kw">lines</span>(year, lm_pred<span class="op">$</span>fit, <span class="dt">col =</span> main.neg, <span class="dt">lwd =</span> <span class="dv">7</span>)
        }
      }
    }
    
    <span class="cf">if</span> (extra <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
      
      <span class="co"># Second variable</span>
      dat &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(x2[, <span class="kw">list</span>(X2, Value)])
    
      dat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">series =</span> Value) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">mutate</span>(<span class="dt">time =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="kw">nrow</span>(dat),<span class="dv">1</span>))
    
     <span class="co"># Fit linear model</span>
      lm_out &lt;-<span class="st"> </span><span class="kw">fit_lm</span>(<span class="dt">dat =</span> dat)
      p &lt;-<span class="st"> </span>lm_out<span class="op">$</span>p
      <span class="kw">points</span>(x2[, <span class="kw">list</span>(X2, Value)], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> point.cex, <span class="dt">col =</span> <span class="st">&quot;indianred&quot;</span>)
      <span class="kw">lines</span>( x2[, <span class="kw">list</span>(X2, Value)], <span class="dt">lwd =</span> lwd, <span class="dt">col =</span> <span class="st">&quot;indianred&quot;</span>)
      <span class="cf">if</span> (p <span class="op">&lt;</span><span class="st"> </span>.<span class="dv">05</span>){
    
        newtime &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(dat<span class="op">$</span>time), <span class="kw">max</span>(dat<span class="op">$</span>time), <span class="dt">length.out=</span><span class="kw">length</span>(dat<span class="op">$</span>time))
        newdata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> newtime,
                      <span class="dt">time2 =</span> newtime<span class="op">^</span><span class="dv">2</span>)
        lm_pred &lt;-<span class="st"> </span>AICcmodavg<span class="op">::</span><span class="kw">predictSE</span>(lm_out<span class="op">$</span>model, 
                                 <span class="dt">newdata =</span> newdata,
                                 <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)

        year &lt;-<span class="st"> </span><span class="kw">seq</span>(x2<span class="op">$</span>X2[<span class="dv">1</span>],x2<span class="op">$</span>X2[<span class="kw">length</span>(x2<span class="op">$</span>X2)],<span class="dt">length.out =</span><span class="kw">length</span>(dat<span class="op">$</span>time))
   
    <span class="co"># Make plot</span>
        <span class="cf">if</span> (lm_pred<span class="op">$</span>fit[<span class="kw">length</span>(lm_pred<span class="op">$</span>fit)] <span class="op">&gt;</span><span class="st"> </span>lm_pred<span class="op">$</span>fit[<span class="dv">1</span>] ){
          <span class="kw">lines</span>(year, lm_pred<span class="op">$</span>fit, <span class="dt">col =</span> main.pos, <span class="dt">lwd =</span> <span class="dv">7</span>)
          <span class="kw">points</span>(x2[, <span class="kw">list</span>(X2, Value)], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> point.cex, <span class="dt">col =</span> <span class="st">&quot;indianred&quot;</span>)
          <span class="kw">lines</span>( x2[, <span class="kw">list</span>(X2, Value)], <span class="dt">lwd =</span> lwd, <span class="dt">col =</span> <span class="st">&quot;indianred&quot;</span>)
        } <span class="cf">else</span> <span class="cf">if</span> (lm_pred<span class="op">$</span>fit[<span class="kw">length</span>(lm_pred<span class="op">$</span>fit)] <span class="op">&lt;</span><span class="st"> </span>lm_pred<span class="op">$</span>fit[<span class="dv">1</span>]){
          <span class="kw">lines</span>(year, lm_pred<span class="op">$</span>fit, <span class="dt">col =</span> main.neg, <span class="dt">lwd =</span> <span class="dv">7</span>)
          <span class="kw">points</span>(x2[, <span class="kw">list</span>(X2, Value)], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> point.cex, <span class="dt">col =</span> <span class="st">&quot;indianred&quot;</span>)
          <span class="kw">lines</span>( x2[, <span class="kw">list</span>(X2, Value)], <span class="dt">lwd =</span> lwd, <span class="dt">col =</span> <span class="st">&quot;indianred&quot;</span>)
        } 
     }
    }

  }


 
}  


<span class="co">#Add axis labels for stacked plots</span>
soe.stacked.axis &lt;-<span class="st"> </span><span class="cf">function</span>(x.label, y.label, <span class="dt">x.line =</span> <span class="fl">2.5</span>,<span class="dt">rel.x.text =</span> <span class="fl">1.5</span>,
                             <span class="dt">y.line =</span> <span class="fl">3.5</span>, <span class="dt">rel.y.text =</span> <span class="fl">1.5</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>){
  <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">cex.axis =</span> rel.x.text)
  <span class="kw">mtext</span>(<span class="dv">1</span>, <span class="dt">text =</span> x.label, <span class="dt">line =</span> x.line, <span class="dt">cex =</span> rel.x.text, <span class="dt">outer =</span> outer)
  <span class="kw">mtext</span>(<span class="dv">2</span>, <span class="dt">text =</span> y.label, <span class="dt">line =</span> y.line, <span class="dt">cex =</span> rel.y.text, <span class="dt">outer =</span> outer)
  
}


<span class="co">#Background colors</span>
background   &lt;-<span class="st"> &#39;white&#39;</span>
recent       &lt;-<span class="st"> &#39;#E6E6E6&#39;</span>
main.pos &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dv">253</span><span class="op">/</span><span class="dv">255</span>, <span class="dv">184</span><span class="op">/</span><span class="dv">255</span>, <span class="dv">99</span><span class="op">/</span><span class="dv">255</span>,  <span class="dt">alpha =</span> .<span class="dv">9</span>)
main.neg &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dv">178</span><span class="op">/</span><span class="dv">255</span>, <span class="dv">171</span><span class="op">/</span><span class="dv">255</span>, <span class="dv">210</span><span class="op">/</span><span class="dv">255</span>, <span class="dt">alpha =</span> .<span class="dv">9</span>)</code></pre></div>
<p><strong>Example plot</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data.dir &lt;-<span class="st"> &quot;data&quot;</span>
<span class="kw">load</span>(<span class="kw">file.path</span>(data.dir,<span class="st">&quot;SOE_data_erddap.Rdata&quot;</span>))

opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">6</span>))

<span class="kw">soe.plot</span>(SOE.data, <span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Mid-Atlantic Rec catch&quot;</span>, <span class="dt">scale.axis =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">6</span>,
         <span class="dt">end.start =</span> <span class="dv">2008</span>, <span class="dt">x.label =</span> <span class="st">&#39;Year&#39;</span>, <span class="dt">rel.y.text =</span> <span class="fl">1.5</span>, <span class="dt">rel.y.num =</span> <span class="fl">1.1</span>,
         <span class="dt">y.line =</span> <span class="fl">2.5</span>, <span class="dt">y.label =</span> <span class="kw">expression</span>(<span class="st">&quot;Fish caught, 10&quot;</span><span class="op">^</span><span class="dv">6</span> <span class="op">*</span><span class="st">&quot; n&quot;</span>))</code></pre></div>
<div class="figure"><span id="fig:examplefig"></span>
<img src="_main_files/figure-html/examplefig-1.png" alt="Example plot formatted for the report" width="672" />
<p class="caption">
Figure 33.1: Example plot formatted for the report
</p>
</div>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-hardison2019">
<p>Hardison, Sean, Charles T Perretti, Geret S DePiper, and Andrew Beet. 2019. “A Simulation Study of Trend Detection Methods for Integrated Ecosystem Assessment.” <em>ICES Journal of Marine Science</em>.</p>
</div>
<div id="ref-Mazerolle2017a">
<p>Mazerolle, Marc J. 2017. “AICcmodavg: model selection and multimodel inference based on (Q)AIC(c).” <a href="https://cran.r-project.org/package=AICcmodavg." class="uri">https://cran.r-project.org/package=AICcmodavg.</a></p>
</div>
<div id="ref-Nicholson2004">
<p>Nicholson, Mike D., and Simon Jennings. 2004. “Testing candidate indicators to support ecosystem-based management: The power of monitoring surveys to detect temporal trends in fish community metrics.” doi:<a href="https://doi.org/10.1016/j.icesjms.2003.09.004">10.1016/j.icesjms.2003.09.004</a>.</p>
</div>
<div id="ref-Pinheiro2017">
<p>Pinheiro, J, D Bates, S DebRoy, D Sarkar, and R Core Team. 2017. “nlme: Linear and Nonlinear Mixed Effects Models.” <em>R Package Version 3.1-131, Https://CRAN.R-Project.org/Package=nlme</em>.</p>
</div>
<div id="ref-VonStorch1999a">
<p>Storch, Hans von. 1999. “Misuses of Statistical Analysis in Climate Research.” In <em>Analysis of Climate Variability</em>, 11–26. doi:<a href="https://doi.org/10.1007/978-3-662-03744-7_2">10.1007/978-3-662-03744-7_2</a>.</p>
</div>
<div id="ref-Wagner2013">
<p>Wagner, Tyler, Brian J. Irwin, James R. Bence, and Daniel B. Hayes. 2013. “Detecting Temporal Trends in Freshwater Fisheries Surveys: Statistical Power and the Important Linkages between Management Questions and Monitoring Objectives.” <em>Fisheries</em> 38 (7): 309–19. doi:<a href="https://doi.org/10.1080/03632415.2013.799466">10.1080/03632415.2013.799466</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="thermal-habitat-projections.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="zooabund.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/NOAA-EDAB/tech-doc/edit/master/chapters/Trend_analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
